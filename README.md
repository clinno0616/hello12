# 銷貨資料分析對話系統

這是一個基於 Streamlit 開發的互動式銷貨資料分析系統，集成了資料視覺化和智慧對話功能，可以幫助使用者快速分析和理解銷貨數據。

## 主要功能

- **Excel 檔案上傳與管理**
  - 支援 .xlsx 和 .xls 格式的 Excel 檔案
  - 支援多工作表（Sheet）選擇
  - 自動顯示數據基本資訊（行數、列數）

- **資料篩選功能**
  - 支援文字欄位多選篩選
  - 支援數值範圍篩選
  - 支援日期區間篩選
  - 動態更新篩選結果

- **資料視覺化**
  - 支援多種圖表類型：
    - 折線圖（可自訂線條形狀和模式）
    - 柱狀圖
    - 散點圖
    - 圓餅圖
    - 長條圖
  - 支援 X 軸和 Y 軸自由選擇
  - 圖表可互動並支援下載

- **智慧對話功能**
  - 整合 Google Gemini AI 模型
  - 支援自然語言提問
  - 針對篩選後的數據進行分析
  - 保存對話歷史記錄

## 系統需求

- Python 3.7 或以上版本
- pip 套件管理器

## 安裝步驟

1. 安裝必要套件：

```bash
pip install streamlit pandas plotly openpyxl xlrd numpy google-generativeai python-dotenv
```

2. 設定環境變數：
   - 建立 `.env` 檔案
   - 加入 Google API 金鑰：
```
GOOGLE_API_KEY=your_api_key_here
```

## 使用說明

1. 啟動應用程式：
```bash
streamlit run app.py
```

2. 使用流程：
   1. 上傳 Excel 檔案
   2. 選擇要分析的工作表
   3. 使用篩選功能縮小資料範圍
   4. 選擇視覺化圖表類型和軸向
   5. 透過對話框提出分析問題

## 注意事項

- 請確保上傳的 Excel 檔案格式正確
- 大型檔案可能需要較長的載入時間
- 使用對話功能時需要確保網路連線正常
- 圖表下載為 HTML 格式，可使用瀏覽器開啟

## 系統限制

- 檔案大小限制取決於系統記憶體
- 對話功能需要有效的 Google API 金鑰
- 圖表類型限於預設的五種選項

## 問題排除

如果遇到以下問題，請嘗試相應的解決方案：

1. 檔案無法上傳
   - 檢查檔案格式是否正確
   - 確認檔案未被其他程式鎖定

2. 圖表無法顯示
   - 確認選擇的欄位資料類型相容
   - 重新選擇不同的圖表類型

3. 對話功能無回應
   - 檢查 API 金鑰設定
   - 確認網路連線狀態
